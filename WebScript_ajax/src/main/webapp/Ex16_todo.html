<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>fetchë¥¼ ì‚¬ìš©í•œ TODO CRUD ì˜ˆì œ</title>
  <style>
    body {
      font-family: Arial;
      max-width: 600px;
      margin: 30px auto;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin: 8px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .completed {
      text-decoration: line-through;
      color: gray;
    }
    button {
      margin-left: 10px;
    }
  </style>
</head>
<body>

  <h2>ğŸ“‹ TODO ë¦¬ìŠ¤íŠ¸ (JSONPlaceholder)</h2>
  <input type="text" id="newTodo" placeholder="í•  ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" />
  <button id="addBtn">ì¶”ê°€</button>

  <ul id="todoList"></ul>

  <script>
  /*
  ëª©ë¡ ì¡°íšŒ	GET	     ìƒìœ„ 5ê°œ í•  ì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
  ì¶”ê°€	    POST	 ìƒˆë¡œìš´ í•  ì¼ì„ ì…ë ¥í•˜ì—¬ ì¶”ê°€
  ìˆ˜ì •	    PUT	     í•  ì¼ ì™„ë£Œ ì—¬ë¶€ í† ê¸€
  ì‚­ì œ	    DELETE	 ì„ íƒí•œ í•  ì¼ ì‚­ì œ
  
  loadTodos()   ê¸°ì¡´ ë°ì´í„° ê°€ì§€ê³  ì˜¤ê¸°
  addTodoToDOM(todo) UI todo í•­ëª© ì¶”ê°€
  addBtn.addEventListener CREATE: í•  ì¼ ì¶”ê°€
  UPDATE: ì™„ë£Œ ìƒíƒœ í† ê¸€
  deleteTodo(id) DELETE: í•  ì¼ ì‚­ì œ
  */
  
  
    const API_URL = "https://jsonplaceholder.typicode.com/todos";
    const todoList = document.getElementById("todoList");
    const addBtn = document.getElementById("addBtn");
    const newTodoInput = document.getElementById("newTodo");

    // âœ… READ: ê¸°ì¡´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    function loadTodos() {
      fetch(API_URL + "?_limit=5") // 5ê°œë§Œ ê°€ì ¸ì˜¤ê¸°
        .then(res => res.json())
        .then(data => {
          todoList.innerHTML = "";
          data.forEach(todo => addTodoToDOM(todo));
        });
    }

    // UIì— TODO ì•„ì´í…œ ì¶”ê°€
    function addTodoToDOM(todo) {
      const li = document.createElement("li");
      li.dataset.id = todo.id;
      li.className = todo.completed ? "completed" : "";
      li.innerHTML = `
        <span>${todo.title}</span>
        <button onclick="toggleTodo(${todo.id})">ì™„ë£Œ</button>
        <button onclick="deleteTodo(${todo.id})">ì‚­ì œ</button>
      `;
      todoList.appendChild(li);
    }

    // âœ… CREATE: í•  ì¼ ì¶”ê°€
    addBtn.addEventListener("click", () => {
      const title = newTodoInput.value.trim();
      if (title === "") return alert("í•  ì¼ì„ ì…ë ¥í•˜ì„¸ìš”!");

      fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          title: title,
          completed: false,
          userId: 1
        })
      })
      .then(res => res.json())
      .then(todo => {
    	console.log("******************");
    	console.log(todo);
    	console.log("******************");
        addTodoToDOM(todo); //ëª©ë¡ì¶”ê°€
        newTodoInput.value = "";
      });
    });

    // UPDATE: ì™„ë£Œ ìƒíƒœ í† ê¸€
    function toggleTodo(id) {
      const li = document.querySelector(`li[data-id='${id}']`);
      const isCompleted = li.classList.contains("completed");

      fetch(`${API_URL}/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          completed: !isCompleted
        })
      })
      .then(res => res.json())
      .then(() => {
        li.classList.toggle("completed");
      });
    }

    // âœ… DELETE: í•  ì¼ ì‚­ì œ
    function deleteTodo(id) {
      fetch(`${API_URL}/${id}`, {
        method: "DELETE"
      })
      .then(() => {
        const li = document.querySelector(`li[data-id='${id}']`);
        if (li) li.remove();
      });
    }

    // ì´ˆê¸° ë¡œë”©
    loadTodos();
  </script>

</body>
</html>
